# Section 08. 자바 메모리 구조와 static

## 자바 메모리 구조

- **메서드 영역**
    - 클래스 정보를 보관한다.
    - 프로그램의 모든 영역에서 공유한다.
    - 프로그램을 실행하는데 필요한 공통 데이터를 관리한다.
        - `클래스 정보`: 클래스의 실행 코드 (바이트 코드),  필드, 메서드와 생성자 코드 등 모든 실행 코드
        - `static 영역` : static 변수들을 보관한다.
        - `런타임 상수 풀` : 프로그램을 실행하는데 필요한 공통 리터럴 상수들을 보관한다.
            - 문자열 풀은 자바 7부터 힙 영역을 이동했다.
- **스택 영역**
    - 실제 프로그램이 실행되는 영역이다.
        - 메서드를 실행할 때마다 하나씩 쌓인다.
    - 자바 실행시 하나의 실행 스택이 생성된다.
        - 각 스택프레임은 지역 변수, 중간 연산 결과, 메서드 호출 등을 포함한다.
        - 스택 프레임
            - 메서드를 호출 할 때마다 하나의 스택 프레임이 쌓인다.
            - 메서드가 종료되면 해당 스택 프레임이 제거된다.
    - 각 쓰레드별로 하나의 실행 스택이 생성된다.
        - 쓰레드 수 만큼 스택 영역이 생성된다.
- **힙 영역**
    - 객체(인스턴스)가 생성되는 영역이다.
        - `new` 명령어를 사용하면 이 영역을 사용한다.
    - 배열이 생성되는 영역이다.
    - 가비지 컬렉션(GC)이 이루어지는 주요 영역이며, 더 이상 참조되지 않는 객체는 GC에 의해 제거된다.

## static 변수

- 인스턴스들 간 공용 가능하며, 클래스에서 관리하는 변수이다.
- 멤버 변수 (필드) 종류
    - 인스턴스 변수: static x
        - 인스턴스를 생성해야 사용할 수 있다.
    - 클래스 변수: static o
        - 정적 변수라고도 불린다.
        - 인스턴스와 무관하게 클래스에 바로 접근해서 사용 가능하다.
        - 클래스 자체에 소속되어 있어서 클래스 변수라 한다.
        - 자바 프로그램을 시작할 때 딱 1개만 만들어진다.

### 변수와 생명 주기

- 지역 변수 (매개변수 포함)
    - 스택 프레임 안에 보관한다.
    - 메서드가 종료되면 스택 프레임도 제거되는데 이때 해당 스택 프레임에 포함된 지역 변수도 함께 제거된다.
- 인스턴스 변수
    - 인스턴스에 있는 멤버 변수이다.
    - 힙 영역을 사용한다.
    - GC가 발생하기 전까지 생명 주기가 이어진다.
- 클래스 변수
    - 메서드 영역의 static 영역에 보관되는 변수이다.
    - 프로그램 전체에서 사용하는 공용 공간이다.
    - 클래스 변수, 정적 변수, static 변수 등으로 불린다.

### 정적 변수 접근법

- 인스턴스를 통한 접근: `dataInstance.count`
    - 인스턴스 변수라고 오해할 수 있기 때문에 사용을 권장하지 않는다.
- 클래스를 통한 접근: `DataClass.count`

## 정적 메서드

- 객체 생성 없이 클래스에 있는 메서드를 바로 호출할 수 있다.
    - static이 붙지 않은 메서드는 `인스턴스 메서드`로 인스턴스를 생성해야 호출 할 수 있다.
- static 메서드는 클래스 내부의 기능을 사용할 때 정적 메서드나 정적 변수만 사용 가능하다.
- 정적 메서드 또는 클래스 메서드라 한다.
- 유틸리티성 메서드에 자주 사용된다.
- 접근법
    - 인스턴스를 통한 접근 `dataInstance.staticCall()`
        - 추천하지 않는다.
    - 클래스를 통한 접근 `DataClass.staticCall()`
- 특정 클래스의 정적메서드 하나만 적용하려면 다음과 같이 생략할 메서드 명을 적어주면 된다.
    - `import static static2.DecoData.staticCall;`
    - `import static static2.DecoData.*;` : 모든 정적 메서드 적용시
    - `staticCall()` 로 바로 사용 가능하다.

```java
public class DecoUtil2 {
    public static String deco(String str) {
        String result = "*" + str + "*";
        return result;
    }
}

public class DecoMain2 {
    public static void main(String[] args) {
        String s = "hello java";
        String deco = DecoUtil2.deco(s);

        System.out.println("before: " + s);
        System.out.println("after: " + deco);
    }
}
 
```
